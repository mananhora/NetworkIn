<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>
var name;
var myEmail;
var myPassword;

$(document).ready(function(){

  $("#loggedIn").hide();

//LOGIN
    $("#logInButton").click(function(){
      var useremail= $("#email").val();
      var userpassword = $("#password").val();
        $.ajax({ url: "users/login",
              type: "POST",
              dataType: "text",

              data:{email: $("#email").val(), password: $("#password").val()},
              success: function(result){
                alert('Success! Welcome!');
                console.log(result);
                var results = JSON.parse(result);
                var uname = results.name;
                name = uname;

                myEmail = useremail;
                myPassword = userpassword;

                $("#loggedIn").show();
                $("#loginName").text(name);
                $("#login").hide();

                }

              });
            });

//UPDATE NAME
    $("#changeNameButton").click(function(){
      var newName = $("#updateName").val();

      //Ajax call
      $.ajax({ url: "users/updateName",
            type: "POST",
            dataType: "text",
            data:{name: newName, email: myEmail, password: myPassword },
            success: function(result){
              alert('Success! Welcome!'+result);
              name = result;
              $("#loginName").text(name);
            }
          });
        });

//SIGN UP BUTTON
    $("#signUpButton").click(function(){
      window.location.href = "/registration.html";
    })
});


</script>
</head>
<body>


<h1>Personal CRM</h1>

<!--DISPLAY WHEN LOGGED IN-->
<div id="loggedIn">
  <p id="loginName"></p>
  <button id = "changeNameButton">Change Name</button>
  <input id = "updateName"  placeholder="type name..">
</div>

<!--DISPLAY WHEN NOT LOGGED IN-->
<div id = "login">
  Type in your email: <input id = "email" type = "text" placeholder="e.g. john.smith@gmail.com"/><br>
  Type in your password: <input id = "password" type = "password"/><br>
  <p> Don't have an account? </p>
  <button id = "signUpButton">Sign up!</button>
  <button id = "logInButton">Log In</button>
</div>


</body>
</html>
